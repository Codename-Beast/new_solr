# Apache Path-Based Solr Admin Configuration
# Generated by Eledia Solr Ansible Role v3.3.1
# Domain: {{ moodle_app_domain | default(inventory_hostname) }}/solr-admin/

# ============================================================================
# INSTRUCTIONS: Add this to your existing VirtualHost for {{ moodle_app_domain | default(inventory_hostname) }}
# ============================================================================

# Solr Admin UI Path-based Access
<Location "/solr-admin">
    ProxyPreserveHost On
    ProxyPass http://127.0.0.1:{{ solr_docker_port | default('8983') }}/solr
    ProxyPassReverse http://127.0.0.1:{{ solr_docker_port | default('8983') }}/solr
    
    # Security Headers
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"
    
    # Allow access from all IPs (Solr has internal authentication)
    Require all granted
    
    {% if solr_admin_user is defined and solr_admin_password is defined %}
    # Optional: Basic Authentication (Solr has its own auth)
    # AuthType Basic
    # AuthName "Solr Admin Access"
    # AuthUserFile /etc/apache2/.htpasswd-solr
    # Require valid-user
    {% endif %}
</Location>

# ============================================================================
# ACCESS URL: https://{{ moodle_app_domain | default(inventory_hostname) }}/solr-admin/
# USERNAME: {{ solr_admin_user | default('admin') }}
# PASSWORD: {{ solr_admin_password | default('[Generated in host_vars]') }}
# ============================================================================